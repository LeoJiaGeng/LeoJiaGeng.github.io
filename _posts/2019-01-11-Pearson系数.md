---
layout:     post
title:  
subtitle:   Pearson系数的由来
date:       2019-01-11
author:     JiaGeng Xiong
header-img: img/post-bg-coffee.jpg
catalog:    false
tags:
    - 六西格玛
---
在以前的学习中，大家都对F(x)这个符号非常熟悉，熟悉到记它几辈子，也解不出来。不管你们理解地怎么“透彻”，我也需要在这里进行赘述。

例如：S = πr2，这是圆的面积公式，这个表达式代表圆的面积与圆的半径存在确定的关系，一个半径只能对应一个面积，即是函数关系，又叫一一对应的关系

那么这个方程最初是怎么被发现的呢？人们将圆的半径放在一列，另一列放置半径应对的面积，试图寻找其中的规律，最终发现如此美妙的面积公式

现实中我们也想寻找类似的规律，给出两组或者多组数据，探究它们之间的“方程”，可总是存在各种影响因素，不会出现上述单纯的方程，但它们之间好像又的确存在某种联系，我们称这种关系叫做相关关系

那么，如何评判两者或多者之间的相关关系呢？在本文仅讨论两者相关关系，并且不区分自变量和因变量的位置关系，减少讨论次数。前人已经给出相关系数的公式，这就有意思了，相关关系的公式如何得来的？我们利用函数关系去探究相关关系的函数关系

首先来看看公式，如下：
公式1

不知道大家是否和我一样，对这个表达式的来源感到好奇，因此查阅大量资料，用自己的言语来表达，若不感兴趣可以直接看结论。

将两组数据进行配对，构成（X,Y）放置在直角坐标系中，并求出两两之间的面积，S =（Y₂-Y₁）*（X2-X1）,若结果为正说明是正相关，为负说明负相关，画图说明：

但是这样工作量非常大，n组数据需要计算Cn₂₃₁¹²³ⁿ½⅓⅔¼¾°℃次，为了减少计算量，数学家将所有数据与数据的均值点进行求解矩阵面积和，这样计算量降低到n，至于为什么可以这样简化，不是本文的关键。公式如下:

S =（Xn-μX）*（Yn-μY）
Stotal = ∑[(Xn-μX)*(Yn-μY)]

假若每个点的概率不一样，那么每个矩阵的面积所占有的权重应该不一样，所以需要加权平均，引入一个概念叫做协方差，对所有面积进行加权就是期望，也就是：

Cov(X, Y)=E[(Xn-μX)(Yn-μY)]
大家注意，此时若把Y换成X，那么Cov(X, X) = σ²(X)，同理，Cov(Y, Y) = σ²(Y)

此时又存在一个问题，有时候我们想知道在众多影响因素中，谁的相关性大，谁的相关性小，因为协方差都带有量纲，相关关系的大小无法比较，举例如下：

身高（cm）与体重(kg)的关系和身高(cm）与年龄（year）之间的关系，无法进行比较，这是需要均一化，除以各自的模，即上述说的σ(X)和σ(Y)，公式如下：

ρ = Cov(X, Y)/[Cov(X, X)·Cov(Y, Y)]½
对其化简，可以得到相关系数r的表达式，是不是和最开始给出来的一致

```python
"""
pearson系数计算
请先安装xlrd模块读取excel
数据放置在前两列，第一行是标题，不要放数据

"""
import xlrd

def re_excel_col(filename, sheet_index):
    '''读取表格中的某些列'''
    print("开始读取文件")
    # 需要读取表格的文件名 ：filename
    # 默认sheet_index = 0 ：sheet_index
    data = xlrd.open_workbook(filename)
    # 读取制定表格的sheet，一般第一个是0
    sheet = data.sheet_by_index(sheet_index)
  
    # 获取x和y的值，首行需要放置标签，x第一列，y第二列
    col_read_x_value = sheet.col_values(0, start_rowx = 1, end_rowx = None)
    col_read_y_value = sheet.col_values(1, start_rowx = 1, end_rowx = None)
    print("已经读取完毕"+ filename , end = '\n')
    pearson(col_read_x_value, col_read_y_value)

def pearson(x_value, y_value):
    """计算Pearson系数"""
    print("\n开始处理数据")
    # 计算X的平均值
    average_x = 0
    for i in x_value:
    average_x += i
    average_x = average_x / len(x_value)
   
    # 计算Y的平均值
    average_y = 0
    for j in y_value:
    average_y += j
    average_y = average_y / len(y_value)
  
    # 计算三个系数
    L_XY = 0
    L_XX = 0
    L_YY = 0
  
    for m,n in zip(x_value, y_value):
    L_XY += (average_x - m) * (average_y - n)
    L_XX += abs(average_x - m)**(2)
    L_YY += abs(average_y - n)**(2)
  
    r = L_XY / (L_XX * L_YY)**(1/2)
    r = format(r, '.8f')
    print("pearson系数为：", r)

re_excel_col(r'd:\Desktop\小程序\1.xlsx', 0)
```
